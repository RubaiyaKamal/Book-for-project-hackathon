"use strict";exports.id=597,exports.ids=[597],exports.modules={1597:(e,t,r)=>{r.d(t,{BunSqliteDialect:()=>p});var s=r(2311),n=r(9762),a=r(469),i=r(6562),o=class{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}get supportsOutput(){return!0}},c=class{#e;#t=new u;#r;#s;constructor(e){this.#e={...e}}async init(){this.#r=this.#e.database,this.#s=new l(this.#r),this.#e.onCreateConnection&&await this.#e.onCreateConnection(this.#s)}async acquireConnection(){return await this.#t.lock(),this.#s}async beginTransaction(e){await e.executeQuery(s.J.raw("begin"))}async commitTransaction(e){await e.executeQuery(s.J.raw("commit"))}async rollbackTransaction(e){await e.executeQuery(s.J.raw("rollback"))}async releaseConnection(){this.#t.unlock()}async destroy(){this.#r?.close()}},l=class{#r;constructor(e){this.#r=e}executeQuery(e){let{sql:t,parameters:r}=e;return Promise.resolve({rows:this.#r.prepare(t).all(r)})}async *streamQuery(){throw Error("Streaming query is not supported by SQLite driver.")}},u=class{#n;#a;async lock(){for(;this.#n;)await this.#n;this.#n=new Promise(e=>{this.#a=e})}unlock(){let e=this.#a;this.#n=void 0,this.#a=void 0,e?.()}},h=class{#r;constructor(e){this.#r=e}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){let t=this.#r.selectFrom("sqlite_schema").where("type","=","table").where("name","not like","sqlite_%").select("name").$castTo();return e.withInternalKyselyTables||(t=t.where("name","!=",n.Q$).where("name","!=",n.q7)),Promise.all((await t.execute()).map(({name:e})=>this.#i(e)))}async getMetadata(e){return{tables:await this.getTables(e)}}async #i(e){let t=this.#r,r=(await t.selectFrom("sqlite_master").where("name","=",e).select("sql").$castTo().execute())[0]?.sql?.split(/[\(\),]/)?.find(e=>e.toLowerCase().includes("autoincrement"))?.split(/\s+/)?.[0]?.replace(/["`]/g,"");return{name:e,columns:(await t.selectFrom((0,a.i)`pragma_table_info(${e})`.as("table_info")).select(["name","type","notnull","dflt_value"]).execute()).map(e=>({name:e.name,dataType:e.type,isNullable:!e.notnull,isAutoIncrementing:e.name===r,hasDefaultValue:null!=e.dflt_value})),isView:!0}}},m=class extends i.C{getCurrentParameterPlaceholder(){return"?"}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}},p=class{#e;constructor(e){this.#e={...e}}createDriver(){return new c(this.#e)}createQueryCompiler(){return new m}createAdapter(){return new o}createIntrospector(e){return new h(e)}}}};