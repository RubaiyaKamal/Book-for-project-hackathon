(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7172:function(e,t,o){Promise.resolve().then(o.t.bind(o,7960,23)),Promise.resolve().then(o.bind(o,1618))},1618:function(e,t,o){"use strict";o.d(t,{AuthProvider:function(){return i},a:function(){return c}});var n=o(7437),r=o(2265),a=o(9376);let u=(0,r.createContext)({user:null,isAuthenticated:!1,loading:!0,login:async()=>"Not implemented",logout:()=>{}}),c=()=>(0,r.useContext)(u);function i(e){let{children:t}=e,[o,c]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0),s=(0,a.useRouter)();(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(e)try{let t=await fetch("http://127.0.0.1:8001/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();c(e)}else localStorage.removeItem("token")}catch(e){console.error("Auth check failed",e)}l(!1)})()},[]);let h=async e=>{localStorage.setItem("token",e);try{console.log("Fetching profile with token:",e.substring(0,10)+"...");let t=await fetch("http://127.0.0.1:8001/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();return c(e),s.push("/dashboard"),null}{let e=t.status,o=await t.text();return console.error("Login fetch failed:",e,o),"Profile load failed: ".concat(e," ").concat(o)}}catch(e){return console.error("Login fetch failed",e),"Network error: ".concat(e.message)}};return(0,n.jsx)(u.Provider,{value:{user:o,isAuthenticated:!!o,loading:i,login:h,logout:()=>{localStorage.removeItem("token"),c(null),s.push("/signin")}},children:t})}},9376:function(e,t,o){"use strict";var n=o(5475);o.o(n,"useRouter")&&o.d(t,{useRouter:function(){return n.useRouter}})},7960:function(){}},function(e){e.O(0,[587,971,117,744],function(){return e(e.s=7172)}),_N_E=e.O()}]);